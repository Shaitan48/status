Примечание по массиву критериев: Текущая реализация Test-SuccessCriteria не поддерживает массив критериев для одного ключа. Если нужны сложные условия "И" для разных подмножеств массива, их нужно либо объединять в один критерий с более сложным _where_ (если возможно), либо создавать отдельные Задания мониторинга.

Возможные ошибки и замечания:

    Версия ОС: Требуется Windows 8 / Windows Server 2012+.

    Права доступа: Обычно не требует повышенных прав.

Зависимости:

    Функции New-CheckResultObject, Test-SuccessCriteria из модуля StatusMonitorAgentUtils.psm1.

    Командлет Get-Volume (модуль Storage).

    IGNORE_WHEN_COPYING_END

Возможные ошибки и замечания:

    Права доступа: Для username и path часто нужны права администратора.

    Производительность: Включение username и path может замедлить проверку.

    Критерии и top_n: Критерии успеха (SuccessCriteria) применяются к полному списку процессов (после фильтрации по process_names, но до применения top_n). Если вам нужно проверить только топ N процессов, это потребует более сложного критерия или отдельной проверки.

Зависимости:

    Функции New-CheckResultObject, Test-SuccessCriteria из модуля StatusMonitorAgentUtils.psm1.

    Командлет Get-Process, Get-CimInstance (стандартные).